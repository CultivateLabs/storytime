<%= simple_form_for [:dashboard, @post] do |f| %>
  <%= f.error_notification %>

  <small><div class="pull-right" id="title_character_limit" data-limit="<%= Storytime.post_title_character_limit %>"></div></small>
  <%= f.input :title, autofocus: true %>
  
  <%= hidden_field_tag :type, @post.type_name %>
  
  <% if lookup_context.template_exists?("storytime/dashboard/posts/_#{@post.type_name}_fields") %>
    <%= render("storytime/dashboard/posts/#{@post.type_name}_fields", f: f)  %>
  <% end %>
  
  <small><div class="pull-right" id="excerpt_character_limit" data-limit="<%= Storytime.post_excerpt_character_limit %>"></div></small>
  <%= f.input :excerpt, required: false %>
  
  <%= f.input :draft_content, as: :text, input_html: { rows: 20, class: "summernote" }, label: "Content" %>

  <%= f.input :featured_media_id, as: :hidden, input_html: { id: "featured_media_id" } %>
  <%= link_to "Select Featured Image", "#", class: "btn btn-default", id: "featured_media_button" %>
  <div id="featured_media_container">
    <%= image_tag @post.featured_media.file_url(:thumb), id: "featured_media_image" if @post.featured_media %>
  </div>
  
  <%= f.input :secondary_media_id, as: :hidden, input_html: { id: "secondary_media_id" } %>
  <%= link_to "Select Secondary Image", "#", class: "btn btn-default", id: "secondary_media_button" %>
  <div id="secondary_media_container">
    <%= image_tag @post.secondary_media.file_url(:thumb), id: "secondary_media_image" if @post.secondary_media %>
  </div>

  <%= f.association :tags, input_html: { :name => 'post[tag_list][]', class: 'chosen-select', multiple: true } %>
  
  <%= f.input :published, as: :boolean, label: false, inline_label: true if Pundit.policy(current_user, @post).publish? %>

  <%= f.input :published_at, as: :date_time_picker if @post.published? %>
  
  <div class="actions">
    <%= f.submit (@post.new_record? ? "Create #{@post.human_name}" : "Update #{@post.human_name}"), class: "btn btn-primary save" %>
  </div>
<% end %>

<%= render "storytime/dashboard/media/modal" %>